"use strict";(self.webpackChunk_react_stockcharts3_stories=self.webpackChunk_react_stockcharts3_stories||[]).push([[1457],{"../core/lib/utils/barWidth.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>plotDataLengthBarWidth});var ___WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../core/lib/utils/index.js");const plotDataLengthBarWidth=(props,moreProps)=>{const{widthRatio}=props,{xAccessor,xScale,plotData}=moreProps,[l,r]=xScale.range();if(null!=xScale.invert){const[dl,dr]=xScale.domain();if("number"==typeof dl&&"number"==typeof dr){return Math.abs(r-l)/Math.abs(dl-dr)*widthRatio}return(xScale(xAccessor((0,___WEBPACK_IMPORTED_MODULE_0__.HV)(plotData)))-xScale(xAccessor((0,___WEBPACK_IMPORTED_MODULE_0__.$1)(plotData))))/plotData.length*widthRatio*.7}return Math.abs(r-l)/xScale.domain().length*widthRatio}},"../scales/lib/timeFormat.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>timeFormat});var d3_time__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/d3-time/src/second.js"),d3_time__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/d3-time/src/minute.js"),d3_time__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/d3-time/src/hour.js"),d3_time__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/d3-time/src/day.js"),d3_time__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/d3-time/src/week.js"),d3_time__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-time/src/month.js"),d3_time__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/d3-time/src/year.js"),d3_time_format__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/d3-time-format/src/defaultLocale.js");const formatMillisecond=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)(".%L"),formatSecond=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)(":%S"),formatMinute=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%H:%M"),formatHour=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%H:%M"),formatDay=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%e"),formatWeek=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%e"),formatMonth=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%b"),formatYear=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%Y"),timeFormat=date=>((0,d3_time__WEBPACK_IMPORTED_MODULE_0__.R)(date)<date?formatMillisecond:(0,d3_time__WEBPACK_IMPORTED_MODULE_1__.wX)(date)<date?formatSecond:(0,d3_time__WEBPACK_IMPORTED_MODULE_2__.Ag)(date)<date?formatMinute:(0,d3_time__WEBPACK_IMPORTED_MODULE_3__.UA)(date)<date?formatHour:(0,d3_time__WEBPACK_IMPORTED_MODULE_5__.Ui)(date)<date?(0,d3_time__WEBPACK_IMPORTED_MODULE_4__.YP)(date)<date?formatDay:formatWeek:(0,d3_time__WEBPACK_IMPORTED_MODULE_6__.he)(date)<date?formatMonth:formatYear)(date)},"../series/lib/CandlestickSeries.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>CandlestickSeries});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/utils/index.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../core/lib/utils/barWidth.js"),d3_array__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-array/src/group.js"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/index.js");class CandlestickSeries extends react__WEBPACK_IMPORTED_MODULE_6__.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const{candleStrokeWidth=CandlestickSeries.defaultProps.candleStrokeWidth}=this.props,{xScale,chartConfig:{yScale},plotData,xAccessor}=moreProps,candleData=this.getCandleData(xAccessor,xScale,yScale,plotData);(0,d3_array__WEBPACK_IMPORTED_MODULE_5__.Ay)(candleData,d=>d.wick.stroke).forEach((values,key)=>{ctx.fillStyle=key,values.forEach(each=>{const d=each.wick;ctx.fillRect(d.x-.5,d.y1,1,d.y2-d.y1),ctx.fillRect(d.x-.5,d.y3,1,d.y4-d.y3)})});(0,d3_array__WEBPACK_IMPORTED_MODULE_5__.Ay)(candleData,d=>d.stroke,d=>d.fill).forEach((strokeValues,strokeKey)=>{"none"!==strokeKey&&(ctx.strokeStyle=strokeKey,ctx.lineWidth=candleStrokeWidth),strokeValues.forEach((values,key)=>{ctx.fillStyle=key,values.forEach(d=>{d.width<=1?ctx.fillRect(d.x-.5,d.y,1,d.height):0===d.height?ctx.fillRect(d.x-.5,d.y,d.width,1):(ctx.fillRect(d.x-.5,d.y,d.width,d.height),"none"!==strokeKey&&ctx.strokeRect(d.x,d.y,d.width,d.height))})})})},this.getCandleData=(xAccessor,xScale,yScale,plotData)=>{const{fill:fillProp,stroke:strokeProp,yAccessor,wickStroke:wickStrokeProp}=this.props,fill=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(fillProp),stroke=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(strokeProp),wickStroke=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(wickStrokeProp),offset=.5*(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(this.props.width)(this.props,{xScale,xAccessor,plotData});return plotData.filter(d=>void 0!==yAccessor(d)).map(d=>{const ohlc=yAccessor(d);if(void 0===ohlc)return;const xValue=xAccessor(d),x=xScale(xValue),y=Math.round(yScale(Math.max(ohlc.open,ohlc.close))),height=Math.max(1,Math.round(Math.abs(yScale(ohlc.open)-yScale(ohlc.close))));return{x:x-offset,y,wick:{stroke:wickStroke(ohlc),x,y1:Math.round(yScale(ohlc.high)),y2:y,y3:y+height,y4:Math.round(yScale(ohlc.low))},height,width:2*offset,fill:fill(ohlc),stroke:stroke(ohlc),direction:ohlc.close-ohlc.open}}).filter(d=>void 0!==d)}}render(){const{clip}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.P,{clip,canvasDraw:this.drawOnCanvas,canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.WJ,drawOn:["pan"]})}}CandlestickSeries.defaultProps={candleStrokeWidth:.5,clip:!0,fill:d=>d.close>d.open?"#26a69a":"#ef5350",stroke:"none",wickStroke:d=>d.close>d.open?"#26a69a":"#ef5350",width:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.h,widthRatio:.8,yAccessor:d=>({open:d.open,high:d.high,low:d.low,close:d.close})}},"./src/data/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>withOHLCData,R:()=>withUpdatingData});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),tsv=__webpack_require__("../../node_modules/d3-dsv/src/tsv.js"),defaultLocale=__webpack_require__("../../node_modules/d3-time-format/src/defaultLocale.js"),react=__webpack_require__("../../node_modules/react/index.js");const parseDate=(0,defaultLocale.T6)("%Y-%m-%d"),parseData=()=>d=>{const date=parseDate(d.date);d.date=null===date?new Date(Number(d.date)):new Date(date);for(const key in d)"date"!==key&&Object.prototype.hasOwnProperty.call(d,key)&&(d[key]=+d[key]);return d};function withOHLCData(dataSet="DAILY"){return OriginalComponent=>class WithOHLCData extends react.Component{constructor(props){super(props),this.state={message:`Loading ${dataSet} data...`}}componentDidMount(){fetch(`https://raw.githubusercontent.com/reactivemarkets/react-financial-charts/master/packages/stories/src/data/${dataSet}.tsv`).then(response=>response.text()).then(data=>(0,tsv.Nu)(data,parseData())).then(data=>{this.setState({data})}).catch(()=>{this.setState({message:"Failed to fetch data."})})}render(){const{data,message}=this.state;return void 0===data?(0,jsx_runtime.jsx)("div",{className:"center",children:message}):(0,jsx_runtime.jsx)(OriginalComponent,{...this.props,data})}}}function withUpdatingData(initialLength=120,interval=1e3){return OriginalComponent=>class WithOHLCData extends react.Component{constructor(props){super(props),this.state={data:props.data.slice(0,initialLength),length:initialLength}}componentDidMount(){this.interval=window.setInterval(()=>{const{data}=this.props,{length}=this.state;length<data.length?this.setState({data:data.slice(0,length+1),length:length+1}):window.clearInterval(this.interval)},interval)}componentWillUnmount(){window.clearInterval(this.interval)}render(){const{data}=this.state;return(0,jsx_runtime.jsx)(OriginalComponent,{...this.props,data})}}}},"./src/features/scales/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,continuousScale:()=>continuousScale,default:()=>index_stories,logScale:()=>logScale,utcScale:()=>utcScale});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),ticks=__webpack_require__("../../node_modules/d3-time/src/ticks.js"),year=__webpack_require__("../../node_modules/d3-time/src/year.js"),month=__webpack_require__("../../node_modules/d3-time/src/month.js"),week=__webpack_require__("../../node_modules/d3-time/src/week.js"),day=__webpack_require__("../../node_modules/d3-time/src/day.js"),hour=__webpack_require__("../../node_modules/d3-time/src/hour.js"),minute=__webpack_require__("../../node_modules/d3-time/src/minute.js"),second=__webpack_require__("../../node_modules/d3-time/src/second.js"),defaultLocale=__webpack_require__("../../node_modules/d3-time-format/src/defaultLocale.js"),time=__webpack_require__("../../node_modules/d3-scale/src/time.js"),init=__webpack_require__("../../node_modules/d3-scale/src/init.js");function utcTime(){return init.C.apply((0,time.B)(ticks.$Z,ticks.lk,year.Mb,month.R6,week.Hl,day.dA,hour.pz,minute.vD,second.R,defaultLocale.aL).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}var src_ticks=__webpack_require__("../../node_modules/d3-array/src/ticks.js"),formatSpecifier=__webpack_require__("../../node_modules/d3-format/src/formatSpecifier.js"),src_defaultLocale=__webpack_require__("../../node_modules/d3-format/src/defaultLocale.js"),nice=__webpack_require__("../../node_modules/d3-scale/src/nice.js"),continuous=__webpack_require__("../../node_modules/d3-scale/src/continuous.js");function transformLog(x){return Math.log(x)}function transformExp(x){return Math.exp(x)}function transformLogn(x){return-Math.log(-x)}function transformExpn(x){return-Math.exp(-x)}function pow10(x){return isFinite(x)?+("1e"+x):x<0?0:x}function reflect(f){return(x,k)=>-f(-x,k)}function loggish(transform){const scale=transform(transformLog,transformExp),domain=scale.domain;let logs,pows,base=10;function rescale(){return logs=function logp(base){return base===Math.E?Math.log:10===base&&Math.log10||2===base&&Math.log2||(base=Math.log(base),x=>Math.log(x)/base)}(base),pows=function powp(base){return 10===base?pow10:base===Math.E?Math.exp:x=>Math.pow(base,x)}(base),domain()[0]<0?(logs=reflect(logs),pows=reflect(pows),transform(transformLogn,transformExpn)):transform(transformLog,transformExp),scale}return scale.base=function(_){return arguments.length?(base=+_,rescale()):base},scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.ticks=count=>{const d=domain();let u=d[0],v=d[d.length-1];const r=v<u;r&&([u,v]=[v,u]);let k,t,i=logs(u),j=logs(v);const n=null==count?10:+count;let z=[];if(!(base%1)&&j-i<n){if(i=Math.floor(i),j=Math.ceil(j),u>0){for(;i<=j;++i)for(k=1;k<base;++k)if(t=i<0?k/pows(-i):k*pows(i),!(t<u)){if(t>v)break;z.push(t)}}else for(;i<=j;++i)for(k=base-1;k>=1;--k)if(t=i>0?k/pows(-i):k*pows(i),!(t<u)){if(t>v)break;z.push(t)}2*z.length<n&&(z=(0,src_ticks.Ay)(u,v,n))}else z=(0,src_ticks.Ay)(i,j,Math.min(j-i,n)).map(pows);return r?z.reverse():z},scale.tickFormat=(count,specifier)=>{if(null==count&&(count=10),null==specifier&&(specifier=10===base?"s":","),"function"!=typeof specifier&&(base%1||null!=(specifier=(0,formatSpecifier.A)(specifier)).precision||(specifier.trim=!0),specifier=(0,src_defaultLocale.GP)(specifier)),count===1/0)return specifier;const k=Math.max(1,base*count/scale.ticks().length);return d=>{let i=d/pows(Math.round(logs(d)));return i*base<base-.5&&(i*=base),i<=k?specifier(d):""}},scale.nice=()=>domain((0,nice.A)(domain(),{floor:x=>pows(Math.floor(logs(x))),ceil:x=>pows(Math.ceil(logs(x)))})),scale}function log(){const scale=loggish((0,continuous.Gu)()).domain([1,10]);return scale.copy=()=>(0,continuous.C)(scale,log()).base(scale.base()),init.C.apply(scale,arguments),scale}var react=__webpack_require__("../../node_modules/react/index.js"),ChartCanvas=__webpack_require__("../core/lib/ChartCanvas.js"),Chart=__webpack_require__("../core/lib/Chart.js"),CandlestickSeries=__webpack_require__("../series/lib/CandlestickSeries.js"),XAxis=__webpack_require__("../axes/lib/XAxis.js"),timeFormat=__webpack_require__("../scales/lib/timeFormat.js"),YAxis=__webpack_require__("../axes/lib/YAxis.js"),withSize=__webpack_require__("../utils/lib/withSize.js"),withDeviceRatio=__webpack_require__("../utils/lib/withDeviceRatio.js"),data=__webpack_require__("./src/data/index.ts");class Scales extends react.Component{constructor(){super(...arguments),this.margin={left:0,right:48,top:0,bottom:24},this.yExtents=data=>[data.high,data.low]}render(){const{data,height,ratio,width,xScale=(0,time.A)(),yScale}=this.props,xAccessor=d=>d.date,max=xAccessor(data[data.length-1]),xExtents=[xAccessor(data[Math.max(0,data.length-100)]),max];return(0,jsx_runtime.jsx)(ChartCanvas.v,{height,ratio,width,margin:this.margin,data,seriesName:"Data",xScale,xAccessor,xExtents,children:(0,jsx_runtime.jsxs)(Chart.t,{id:1,yExtents:this.yExtents,yScale,children:[(0,jsx_runtime.jsx)(CandlestickSeries.H,{}),(0,jsx_runtime.jsx)(XAxis.W,{tickFormat:timeFormat.D}),(0,jsx_runtime.jsx)(YAxis.h,{tickFormat:(0,src_defaultLocale.GP)(".2f")})]})})}}const Daily=(0,data.p)()((0,withSize.U)({style:{minHeight:600}})((0,withDeviceRatio.O)()(Scales))),index_stories={title:"Features/Scales",component:Daily},continuousScale={render:()=>(0,jsx_runtime.jsx)(Daily,{})},utcScale={render:()=>(0,jsx_runtime.jsx)(Daily,{xScale:utcTime()})},logScale={render:()=>(0,jsx_runtime.jsx)(Daily,{yScale:log()})},__namedExportsOrder=["continuousScale","utcScale","logScale"];continuousScale.parameters={...continuousScale.parameters,docs:{...continuousScale.parameters?.docs,source:{originalSource:"{\n  render: () => <Daily />\n}",...continuousScale.parameters?.docs?.source}}},utcScale.parameters={...utcScale.parameters,docs:{...utcScale.parameters?.docs,source:{originalSource:"{\n  render: () => <Daily xScale={scaleUtc()} />\n}",...utcScale.parameters?.docs?.source}}},logScale.parameters={...logScale.parameters,docs:{...logScale.parameters?.docs,source:{originalSource:"{\n  render: () => <Daily yScale={scaleLog()} />\n}",...logScale.parameters?.docs?.source}}}}}]);