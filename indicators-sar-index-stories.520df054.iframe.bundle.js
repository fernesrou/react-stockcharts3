"use strict";(self.webpackChunk_react_stockcharts3_stories=self.webpackChunk_react_stockcharts3_stories||[]).push([[8459],{"../../node_modules/d3-dsv/src/tsv.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Nu:()=>tsvParse});var EOL={},EOF={};function objectConverter(columns){return new Function("d","return {"+columns.map(function(name,i){return JSON.stringify(name)+": d["+i+'] || ""'}).join(",")+"}")}function inferColumns(rows){var columnSet=Object.create(null),columns=[];return rows.forEach(function(row){for(var column in row)column in columnSet||columns.push(columnSet[column]=column)}),columns}function pad(value,width){var s=value+"",length=s.length;return length<width?new Array(width-length+1).join(0)+s:s}function formatDate(date){var hours=date.getUTCHours(),minutes=date.getUTCMinutes(),seconds=date.getUTCSeconds(),milliseconds=date.getUTCMilliseconds();return isNaN(date)?"Invalid Date":function formatYear(year){return year<0?"-"+pad(-year,6):year>9999?"+"+pad(year,6):pad(year,4)}(date.getUTCFullYear())+"-"+pad(date.getUTCMonth()+1,2)+"-"+pad(date.getUTCDate(),2)+(milliseconds?"T"+pad(hours,2)+":"+pad(minutes,2)+":"+pad(seconds,2)+"."+pad(milliseconds,3)+"Z":seconds?"T"+pad(hours,2)+":"+pad(minutes,2)+":"+pad(seconds,2)+"Z":minutes||hours?"T"+pad(hours,2)+":"+pad(minutes,2)+"Z":"")}var tsv=function dsv(delimiter){var reFormat=new RegExp('["'+delimiter+"\n\r]"),DELIMITER=delimiter.charCodeAt(0);function parseRows(text,f){var t,rows=[],N=text.length,I=0,n=0,eof=N<=0,eol=!1;function token(){if(eof)return EOF;if(eol)return eol=!1,EOL;var i,c,j=I;if(34===text.charCodeAt(j)){for(;I++<N&&34!==text.charCodeAt(I)||34===text.charCodeAt(++I););return(i=I)>=N?eof=!0:10===(c=text.charCodeAt(I++))?eol=!0:13===c&&(eol=!0,10===text.charCodeAt(I)&&++I),text.slice(j+1,i-1).replace(/""/g,'"')}for(;I<N;){if(10===(c=text.charCodeAt(i=I++)))eol=!0;else if(13===c)eol=!0,10===text.charCodeAt(I)&&++I;else if(c!==DELIMITER)continue;return text.slice(j,i)}return eof=!0,text.slice(j,N)}for(10===text.charCodeAt(N-1)&&--N,13===text.charCodeAt(N-1)&&--N;(t=token())!==EOF;){for(var row=[];t!==EOL&&t!==EOF;)row.push(t),t=token();f&&null==(row=f(row,n++))||rows.push(row)}return rows}function preformatBody(rows,columns){return rows.map(function(row){return columns.map(function(column){return formatValue(row[column])}).join(delimiter)})}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(value){return null==value?"":value instanceof Date?formatDate(value):reFormat.test(value+="")?'"'+value.replace(/"/g,'""')+'"':value}return{parse:function parse(text,f){var convert,columns,rows=parseRows(text,function(row,i){if(convert)return convert(row,i-1);columns=row,convert=f?function customConverter(columns,f){var object=objectConverter(columns);return function(row,i){return f(object(row),i,columns)}}(row,f):objectConverter(row)});return rows.columns=columns||[],rows},parseRows,format:function format(rows,columns){return null==columns&&(columns=inferColumns(rows)),[columns.map(formatValue).join(delimiter)].concat(preformatBody(rows,columns)).join("\n")},formatBody:function formatBody(rows,columns){return null==columns&&(columns=inferColumns(rows)),preformatBody(rows,columns).join("\n")},formatRows:function formatRows(rows){return rows.map(formatRow).join("\n")},formatRow,formatValue}}("\t"),tsvParse=tsv.parse;tsv.parseRows,tsv.format,tsv.formatBody,tsv.formatRows,tsv.formatRow,tsv.formatValue},"../../node_modules/d3-scale/src/ordinal.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>ordinal});var d3_array__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/internmap/src/index.js"),_init_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/d3-scale/src/init.js");const implicit=Symbol("implicit");function ordinal(){var index=new d3_array__WEBPACK_IMPORTED_MODULE_0__.B,domain=[],range=[],unknown=implicit;function scale(d){let i=index.get(d);if(void 0===i){if(unknown!==implicit)return unknown;index.set(d,i=domain.push(d)-1)}return range[i%range.length]}return scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=new d3_array__WEBPACK_IMPORTED_MODULE_0__.B;for(const value of _)index.has(value)||index.set(value,domain.push(value)-1);return scale},scale.range=function(_){return arguments.length?(range=Array.from(_),scale):range.slice()},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},scale.copy=function(){return ordinal(domain,range).unknown(unknown)},_init_js__WEBPACK_IMPORTED_MODULE_1__.C.apply(scale,arguments),scale}},"../../node_modules/internmap/src/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>InternMap});class InternMap extends Map{constructor(entries,key=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:key}}),null!=entries)for(const[key,value]of entries)this.set(key,value)}get(key){return super.get(intern_get(this,key))}has(key){return super.has(intern_get(this,key))}set(key,value){return super.set(intern_set(this,key),value)}delete(key){return super.delete(intern_delete(this,key))}}Set;function intern_get({_intern,_key},value){const key=_key(value);return _intern.has(key)?_intern.get(key):value}function intern_set({_intern,_key},value){const key=_key(value);return _intern.has(key)?_intern.get(key):(_intern.set(key,value),value)}function intern_delete({_intern,_key},value){const key=_key(value);return _intern.has(key)&&(value=_intern.get(value),_intern.delete(key)),value}function keyof(value){return null!==value&&"object"==typeof value?value.valueOf():value}},"../indicators/lib/calculator/defaultOptionsForComputation.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Be:()=>Kagi,Mb:()=>Renko,Wq:()=>ForceIndex,Xt:()=>SAR,ZV:()=>FullStochasticOscillator,Zi:()=>RSI,e0:()=>MACD,jt:()=>ElderRay,lY:()=>Change,mV:()=>EMA,q7:()=>PointAndFigure,qd:()=>BollingerBand,yJ:()=>ATR});const BollingerBand={windowSize:20,sourcePath:"close",multiplier:2,movingAverageType:"sma"},ATR={windowSize:14},ForceIndex={sourcePath:"close",volumePath:"volume"},Change={sourcePath:"close",basePath:"close",mainKeys:[],compareKeys:[]},ElderRay={windowSize:13,sourcePath:"close",movingAverageType:"sma"},SAR={accelerationFactor:.02,maxAccelerationFactor:.2},MACD={fast:12,slow:26,signal:9,sourcePath:"close"},FullStochasticOscillator={windowSize:12,kWindowSize:3,dWindowSize:3},RSI={windowSize:14,sourcePath:"close"},EMA={sourcePath:"close",windowSize:10},Kagi={reversalType:"ATR",windowSize:14,reversal:2,sourcePath:"close"},Renko={reversalType:"ATR",windowSize:14,fixedBrickSize:2,sourcePath:"high/low"},PointAndFigure={boxSize:.5,reversal:3,sourcePath:"high/low"}},"../indicators/lib/utils/functor.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>functor});const functor=v=>"function"==typeof v?v:()=>v},"../indicators/lib/utils/identity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>identity});const identity=d=>d},"../indicators/lib/utils/mappedSlidingWindow.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _functor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../indicators/lib/utils/functor.js"),_identity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../indicators/lib/utils/identity.js");function __WEBPACK_DEFAULT_EXPORT__(){let undefinedValue,windowSize=10,accumulator=()=>{},source=_identity__WEBPACK_IMPORTED_MODULE_1__.D,skipInitial=0;const mappedSlidingWindow=function(data){const size=(0,_functor__WEBPACK_IMPORTED_MODULE_0__.E)(windowSize).apply(this,arguments),windowData=[];let accumulatorIdx=0;const undef=(0,_functor__WEBPACK_IMPORTED_MODULE_0__.E)(undefinedValue),result=[];return data.forEach(function(d,i){let mapped;if(i<skipInitial+size-1)return mapped=undef(d,i),result.push(mapped),void windowData.push(mapped);i>=skipInitial+size&&windowData.shift(),windowData.push(source(d,i)),mapped=accumulator(windowData,i,accumulatorIdx++),result.push(mapped),windowData.pop(),windowData.push(mapped)}),result};return mappedSlidingWindow.undefinedValue=function(x){return arguments.length?(undefinedValue=x,mappedSlidingWindow):undefinedValue},mappedSlidingWindow.windowSize=function(x){return arguments.length?(windowSize=x,mappedSlidingWindow):windowSize},mappedSlidingWindow.accumulator=function(x){return arguments.length?(accumulator=x,mappedSlidingWindow):accumulator},mappedSlidingWindow.skipInitial=function(x){return arguments.length?(skipInitial=x,mappedSlidingWindow):skipInitial},mappedSlidingWindow.source=function(x){return arguments.length?(source=x,mappedSlidingWindow):source},mappedSlidingWindow}},"../indicators/lib/utils/merge.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _zipper__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../indicators/lib/utils/zipper.js"),_identity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../indicators/lib/utils/identity.js");function __WEBPACK_DEFAULT_EXPORT__(){let algorithm=_identity__WEBPACK_IMPORTED_MODULE_1__.D,skipUndefined=!0,merge=()=>{};const mergeCompute=data=>(0,_zipper__WEBPACK_IMPORTED_MODULE_0__.A)().combine((datum,indicator)=>{const result=skipUndefined&&void 0===indicator?datum:merge(datum,indicator);return void 0===result?datum:result})(data,algorithm(data));return mergeCompute.algorithm=newAlgorithm=>void 0===newAlgorithm?algorithm:(algorithm=newAlgorithm,mergeCompute),mergeCompute.merge=newMerge=>void 0===newMerge?merge:(merge=newMerge,mergeCompute),mergeCompute.skipUndefined=newSkipUndefined=>void 0===newSkipUndefined?skipUndefined:(skipUndefined=newSkipUndefined,mergeCompute),mergeCompute}},"../indicators/lib/utils/zipper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>zipper});var d3_array__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/d3-array/src/min.js"),_identity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../indicators/lib/utils/identity.js");function zipper(){let combine=_identity__WEBPACK_IMPORTED_MODULE_1__.D;function zip(){const n=arguments.length;if(0===n)return[];const m=(0,d3_array__WEBPACK_IMPORTED_MODULE_0__.A)(arguments,d3_zipLength)??0,zips=new Array(m);for(let i=-1;++i<m;){for(let j=-1,zip=zips[i]=new Array(n);++j<n;)zip[j]=arguments[j][i];zips[i]=combine.apply(this,zips[i])}return zips}function d3_zipLength(d){return d.length}return zip.combine=function(x){return arguments.length?(combine=x,zip):combine},zip}},"../tooltip/lib/SingleValueTooltip.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>SingleValueTooltip});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/utils/identity.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/utils/noop.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../core/lib/utils/index.js"),d3_format__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-format/src/defaultLocale.js"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/index.js"),_ToolTipText__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../tooltip/lib/ToolTipText.js"),_ToolTipTSpanLabel__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../tooltip/lib/ToolTipTSpanLabel.js");class SingleValueTooltip extends react__WEBPACK_IMPORTED_MODULE_6__.Component{constructor(){super(...arguments),this.renderSVG=moreProps=>{const{onClick,fontFamily,fontSize,fontWeight,labelFill,labelFontWeight,valueFill,className,displayValuesFor=SingleValueTooltip.defaultProps.displayValuesFor,origin:originProp,xDisplayFormat=SingleValueTooltip.defaultProps.xDisplayFormat,yDisplayFormat=SingleValueTooltip.defaultProps.yDisplayFormat,xLabel,yLabel,xAccessor=SingleValueTooltip.defaultProps.xAccessor,yAccessor=SingleValueTooltip.defaultProps.yAccessor,xInitDisplay,yInitDisplay}=this.props,{chartConfig:{width,height},fullData}=moreProps,currentItem=displayValuesFor(this.props,moreProps)??(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.HV)(fullData);let xDisplayValue=xInitDisplay,yDisplayValue=yInitDisplay;if(void 0!==currentItem){const xItem=xAccessor(currentItem);void 0!==xItem&&(xDisplayValue=xDisplayFormat(xItem));const yItem=yAccessor(currentItem);void 0!==yItem&&(yDisplayValue=yDisplayFormat(yItem))}const origin=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.ER)(originProp),[x,y]=origin(width,height);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("g",{className,transform:`translate(${x}, ${y})`,onClick,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_ToolTipText__WEBPACK_IMPORTED_MODULE_7__.z,{x:0,y:0,fontFamily,fontSize,fontWeight,children:[xLabel?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ToolTipTSpanLabel__WEBPACK_IMPORTED_MODULE_8__.O,{x:0,dy:"5",fill:labelFill,children:`${xLabel}: `}):null,xLabel?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("tspan",{fill:valueFill,children:`${xDisplayValue} `}):null,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ToolTipTSpanLabel__WEBPACK_IMPORTED_MODULE_8__.O,{fill:labelFill,fontWeight:labelFontWeight,children:`${yLabel} `}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("tspan",{fill:valueFill,children:yDisplayValue})]})})}}render(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.P,{clip:!1,svgDraw:this.renderSVG,drawOn:["mousemove"]})}}SingleValueTooltip.defaultProps={className:"react-financial-charts-tooltip",displayValuesFor:(_,props)=>props.currentItem,labelFill:"#4682B4",origin:[0,0],valueFill:"#000000",xAccessor:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.l,xDisplayFormat:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.D,xInitDisplay:"n/a",yAccessor:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.D,yDisplayFormat:(0,d3_format__WEBPACK_IMPORTED_MODULE_5__.GP)(".2f"),yInitDisplay:"n/a"}},"../tooltip/lib/ToolTipTSpanLabel.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>ToolTipTSpanLabel});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js");class ToolTipTSpanLabel extends react__WEBPACK_IMPORTED_MODULE_1__.PureComponent{render(){const{children,...rest}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("tspan",{...rest,children})}}ToolTipTSpanLabel.defaultProps={className:"react-financial-charts-tooltip-label",fill:"#4682B4"}},"../tooltip/lib/ToolTipText.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{z:()=>ToolTipText});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js");class ToolTipText extends react__WEBPACK_IMPORTED_MODULE_1__.PureComponent{render(){const{children,...rest}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("text",{...rest,children})}}ToolTipText.defaultProps={className:"react-financial-charts-tooltip",fontFamily:"-apple-system, system-ui, 'Helvetica Neue', Ubuntu, sans-serif",fontSize:11}},"./src/indicators/sar/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,basic:()=>basic,default:()=>index_stories});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react=__webpack_require__("../../node_modules/react/index.js"),utils=__webpack_require__("../core/lib/utils/index.js"),GenericComponent=__webpack_require__("../core/lib/GenericComponent.js"),GenericChartComponent=__webpack_require__("../core/lib/GenericChartComponent.js");class SARSeries extends react.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const{yAccessor,fillStyle=SARSeries.defaultProps.fillStyle,strokeStyle}=this.props,{xAccessor,plotData,xScale,chartConfig:{yScale},hovering}=moreProps,d=(xScale(xAccessor((0,utils.HV)(plotData)))-xScale(xAccessor((0,utils.$1)(plotData))))/plotData.length*.5/2,radius=Math.min(2,Math.max(.5,d))+(hovering?2:0);plotData.forEach(each=>{const yValue=yAccessor(each);if(void 0===yValue)return;const centerX=xScale(xAccessor(each)),centerY=yScale(yValue),color=yValue>each.close?fillStyle.falling:fillStyle.rising;ctx.fillStyle=color,void 0!==strokeStyle&&(ctx.strokeStyle=yValue>each.close?strokeStyle.falling:strokeStyle.rising),ctx.beginPath(),ctx.ellipse(centerX,centerY,radius,radius,0,0,2*Math.PI),ctx.closePath(),ctx.fill(),void 0!==strokeStyle&&ctx.stroke()})},this.isHover=moreProps=>{const{mouseXY,currentItem,chartConfig:{yScale}}=moreProps,{yAccessor}=this.props,y=mouseXY[1],currentY=yScale(yAccessor(currentItem));return y<currentY+5&&y>currentY-5}}render(){const{highlightOnHover,onClick,onDoubleClick,onContextMenu}=this.props,hoverProps=highlightOnHover?{isHover:this.isHover,drawOn:["mousemove","pan"],canvasToDraw:GenericComponent.wk}:{drawOn:["pan"],canvasToDraw:GenericComponent.WJ};return(0,jsx_runtime.jsx)(GenericChartComponent.P,{canvasDraw:this.drawOnCanvas,onClickWhenHover:onClick,onDoubleClickWhenHover:onDoubleClick,onContextMenuWhenHover:onContextMenu,...hoverProps})}}SARSeries.defaultProps={fillStyle:{falling:"#4682B4",rising:"#15EC2E"},highlightOnHover:!1};var ChartCanvas=__webpack_require__("../core/lib/ChartCanvas.js"),Chart=__webpack_require__("../core/lib/Chart.js"),XAxis=__webpack_require__("../axes/lib/XAxis.js"),YAxis=__webpack_require__("../axes/lib/YAxis.js"),merge=__webpack_require__("../indicators/lib/utils/merge.js"),rebind=__webpack_require__("../indicators/lib/utils/rebind.js"),mappedSlidingWindow=__webpack_require__("../indicators/lib/utils/mappedSlidingWindow.js"),defaultOptionsForComputation=__webpack_require__("../indicators/lib/calculator/defaultOptionsForComputation.js");function sar(){let options=defaultOptionsForComputation.Xt;const calculator=data=>{const{accelerationFactor,maxAccelerationFactor}=options;return(0,mappedSlidingWindow.A)().windowSize(2).undefinedValue(({high,low})=>({risingSar:low,risingEp:high,fallingSar:high,fallingEp:low,af:accelerationFactor})).accumulator(([prev,now])=>{const{risingSar,fallingSar,risingEp,fallingEp}=function calc(prev,now){return{risingSar:prev.risingSar+prev.af*(prev.risingEp-prev.risingSar),fallingSar:prev.fallingSar-prev.af*(prev.fallingSar-prev.fallingEp),risingEp:Math.max(prev.risingEp,now.high),fallingEp:Math.min(prev.fallingEp,now.low)}}(prev,now);if(void 0===prev.use&&risingSar>now.low&&fallingSar<now.high)return{risingSar,fallingSar,risingEp,fallingEp};const use=void 0!==prev.use?"rising"===prev.use?risingSar>now.low?"falling":"rising":fallingSar<now.high?"rising":"falling":risingSar>now.low?"falling":"rising",current=prev.use===use?{af:Math.min(maxAccelerationFactor,prev.af+accelerationFactor),fallingEp,risingEp,fallingSar,risingSar}:{af:accelerationFactor,fallingEp:now.low,risingEp:now.high,fallingSar:Math.max(prev.risingEp,now.high),risingSar:Math.min(prev.fallingEp,now.low)},{date,high,low}=now;return{date,high,low,...current,use,sar:"falling"===use?current.fallingSar:current.risingSar}})(data).map(d=>d.sar)};return calculator.undefinedLength=()=>1,calculator.options=newOptions=>void 0===newOptions?options:(options={...defaultOptionsForComputation.Xt,...newOptions},calculator),calculator}var baseIndicator=__webpack_require__("../indicators/lib/indicator/baseIndicator.js");var discontinuousTimeScaleProvider=__webpack_require__("../scales/lib/discontinuousTimeScaleProvider.js");class SARSeries_SARSeries extends react.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const{yAccessor,fillStyle=SARSeries_SARSeries.defaultProps.fillStyle,strokeStyle}=this.props,{xAccessor,plotData,xScale,chartConfig:{yScale},hovering}=moreProps,d=(xScale(xAccessor((0,utils.HV)(plotData)))-xScale(xAccessor((0,utils.$1)(plotData))))/plotData.length*.5/2,radius=Math.min(2,Math.max(.5,d))+(hovering?2:0);plotData.forEach(each=>{const yValue=yAccessor(each);if(void 0===yValue)return;const centerX=xScale(xAccessor(each)),centerY=yScale(yValue),color=yValue>each.close?fillStyle.falling:fillStyle.rising;ctx.fillStyle=color,void 0!==strokeStyle&&(ctx.strokeStyle=yValue>each.close?strokeStyle.falling:strokeStyle.rising),ctx.beginPath(),ctx.ellipse(centerX,centerY,radius,radius,0,0,2*Math.PI),ctx.closePath(),ctx.fill(),void 0!==strokeStyle&&ctx.stroke()})},this.isHover=moreProps=>{const{mouseXY,currentItem,chartConfig:{yScale}}=moreProps,{yAccessor}=this.props,y=mouseXY[1],currentY=yScale(yAccessor(currentItem));return y<currentY+5&&y>currentY-5}}render(){const{highlightOnHover,onClick,onDoubleClick,onContextMenu}=this.props,hoverProps=highlightOnHover?{isHover:this.isHover,drawOn:["mousemove","pan"],canvasToDraw:GenericComponent.wk}:{drawOn:["pan"],canvasToDraw:GenericComponent.WJ};return(0,jsx_runtime.jsx)(GenericChartComponent.P,{canvasDraw:this.drawOnCanvas,onClickWhenHover:onClick,onDoubleClickWhenHover:onDoubleClick,onContextMenuWhenHover:onContextMenu,...hoverProps})}}SARSeries_SARSeries.defaultProps={fillStyle:{falling:"#4682B4",rising:"#15EC2E"},highlightOnHover:!1};var SingleValueTooltip=__webpack_require__("../tooltip/lib/SingleValueTooltip.js"),data=__webpack_require__("./src/data/index.ts"),withSize=__webpack_require__("../utils/lib/withSize.js"),withDeviceRatio=__webpack_require__("../utils/lib/withDeviceRatio.js");class SARIndicator extends react.Component{constructor(){super(...arguments),this.accelerationFactor=.02,this.maxAccelerationFactor=.2,this.margin={left:0,right:40,top:8,bottom:24},this.xScaleProvider=(0,discontinuousTimeScaleProvider.L)().inputDateAccessor(d=>d.date),this.sarCalculator=function indicator_sar(){const base=(0,baseIndicator.A)().type("SMA").accessor(d=>d.sar),underlyingAlgorithm=sar(),mergedAlgorithm=(0,merge.A)().algorithm(underlyingAlgorithm).merge((datum,i)=>{datum.sar=i}),indicator=(data,options={merge:!0})=>{if(options.merge){if(!base.accessor())throw new Error("Set an accessor to SMA before calculating");return mergedAlgorithm(data)}return underlyingAlgorithm(data)};return(0,rebind.A)(indicator,base,"id","accessor","stroke","echo","type"),(0,rebind.A)(indicator,underlyingAlgorithm,"options","undefinedLength"),(0,rebind.A)(indicator,mergedAlgorithm,"merge"),indicator}().options({accelerationFactor:this.accelerationFactor,maxAccelerationFactor:this.maxAccelerationFactor}).merge((d,c)=>{d.sar=c}).accessor(d=>d.sar)}render(){const{data:initialData,height,ratio,width}=this.props,calculatedData=this.sarCalculator(initialData),{data,xScale,xAccessor,displayXAccessor}=this.xScaleProvider(calculatedData),max=xAccessor(data[data.length-1]),xExtents=[xAccessor(data[Math.max(0,data.length-100)]),max],yAccessor=this.sarCalculator.accessor();return(0,jsx_runtime.jsx)(ChartCanvas.v,{height,ratio,width,margin:this.margin,data,displayXAccessor,seriesName:"Data",xScale,xAccessor,xExtents,children:(0,jsx_runtime.jsxs)(Chart.t,{id:1,yExtents:yAccessor,children:[(0,jsx_runtime.jsx)(XAxis.W,{}),(0,jsx_runtime.jsx)(YAxis.h,{}),(0,jsx_runtime.jsx)(SARSeries_SARSeries,{yAccessor}),(0,jsx_runtime.jsx)(SingleValueTooltip.b,{yLabel:`SAR (${this.accelerationFactor}, ${this.maxAccelerationFactor})`,yAccessor,origin:[8,8]})]})})}}const SarIndicator=(0,data.p)()((0,withSize.U)({style:{minHeight:600}})((0,withDeviceRatio.O)()(SARIndicator))),index_stories={title:"Visualization/Indicator/SAR",component:SARSeries},basic={render:()=>(0,jsx_runtime.jsx)(SarIndicator,{})},__namedExportsOrder=["basic"];basic.parameters={...basic.parameters,docs:{...basic.parameters?.docs,source:{originalSource:"{\n  render: () => <SARIndicator />\n}",...basic.parameters?.docs?.source}}}}}]);