"use strict";(self.webpackChunk_react_stockcharts3_stories=self.webpackChunk_react_stockcharts3_stories||[]).push([[3314],{"../core/lib/utils/barWidth.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>plotDataLengthBarWidth});var ___WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../core/lib/utils/index.js");const plotDataLengthBarWidth=(props,moreProps)=>{const{widthRatio}=props,{xAccessor,xScale,plotData}=moreProps,[l,r]=xScale.range();if(null!=xScale.invert){const[dl,dr]=xScale.domain();if("number"==typeof dl&&"number"==typeof dr){return Math.abs(r-l)/Math.abs(dl-dr)*widthRatio}return(xScale(xAccessor((0,___WEBPACK_IMPORTED_MODULE_0__.HV)(plotData)))-xScale(xAccessor((0,___WEBPACK_IMPORTED_MODULE_0__.$1)(plotData))))/plotData.length*widthRatio*.7}return Math.abs(r-l)/xScale.domain().length*widthRatio}},"../indicators/lib/calculator/defaultOptionsForComputation.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Be:()=>Kagi,Mb:()=>Renko,Wq:()=>ForceIndex,Xt:()=>SAR,ZV:()=>FullStochasticOscillator,Zi:()=>RSI,e0:()=>MACD,jt:()=>ElderRay,lY:()=>Change,mV:()=>EMA,q7:()=>PointAndFigure,qd:()=>BollingerBand,yJ:()=>ATR});const BollingerBand={windowSize:20,sourcePath:"close",multiplier:2,movingAverageType:"sma"},ATR={windowSize:14},ForceIndex={sourcePath:"close",volumePath:"volume"},Change={sourcePath:"close",basePath:"close",mainKeys:[],compareKeys:[]},ElderRay={windowSize:13,sourcePath:"close",movingAverageType:"sma"},SAR={accelerationFactor:.02,maxAccelerationFactor:.2},MACD={fast:12,slow:26,signal:9,sourcePath:"close"},FullStochasticOscillator={windowSize:12,kWindowSize:3,dWindowSize:3},RSI={windowSize:14,sourcePath:"close"},EMA={sourcePath:"close",windowSize:10},Kagi={reversalType:"ATR",windowSize:14,reversal:2,sourcePath:"close"},Renko={reversalType:"ATR",windowSize:14,fixedBrickSize:2,sourcePath:"high/low"},PointAndFigure={boxSize:.5,reversal:3,sourcePath:"high/low"}},"../indicators/lib/calculator/ema.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../indicators/lib/utils/path.js"),_defaultOptionsForComputation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../indicators/lib/calculator/defaultOptionsForComputation.js");function __WEBPACK_DEFAULT_EXPORT__(){let options=_defaultOptionsForComputation__WEBPACK_IMPORTED_MODULE_1__.mV;const calculator=data=>{const{windowSize,sourcePath}=options,source=(0,_utils__WEBPACK_IMPORTED_MODULE_0__.A)(sourcePath),alpha=2/(windowSize+1);let previous,initialAccumulator=0,skip=0;return data.map(function(d,i){const v=source(d,i);if(void 0!==previous||void 0!==v){if(!(i<windowSize+skip-1)){if(i===windowSize+skip-1){initialAccumulator+=v;const initialValue=initialAccumulator/windowSize;return previous=initialValue,initialValue}{const nextValue=v*alpha+(1-alpha)*previous;return previous=nextValue,nextValue}}initialAccumulator+=v}else skip++})};return calculator.undefinedLength=()=>{const{windowSize}=options;return windowSize-1},calculator.options=newOptions=>void 0===newOptions?options:(options={..._defaultOptionsForComputation__WEBPACK_IMPORTED_MODULE_1__.mV,...newOptions},calculator),calculator}},"../indicators/lib/utils/functor.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>functor});const functor=v=>"function"==typeof v?v:()=>v},"../indicators/lib/utils/identity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>identity});const identity=d=>d},"../indicators/lib/utils/merge.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _zipper__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../indicators/lib/utils/zipper.js"),_identity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../indicators/lib/utils/identity.js");function __WEBPACK_DEFAULT_EXPORT__(){let algorithm=_identity__WEBPACK_IMPORTED_MODULE_1__.D,skipUndefined=!0,merge=()=>{};const mergeCompute=data=>(0,_zipper__WEBPACK_IMPORTED_MODULE_0__.A)().combine((datum,indicator)=>{const result=skipUndefined&&void 0===indicator?datum:merge(datum,indicator);return void 0===result?datum:result})(data,algorithm(data));return mergeCompute.algorithm=newAlgorithm=>void 0===newAlgorithm?algorithm:(algorithm=newAlgorithm,mergeCompute),mergeCompute.merge=newMerge=>void 0===newMerge?merge:(merge=newMerge,mergeCompute),mergeCompute.skipUndefined=newSkipUndefined=>void 0===newSkipUndefined?skipUndefined:(skipUndefined=newSkipUndefined,mergeCompute),mergeCompute}},"../indicators/lib/utils/path.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>path});const path=(loc=[])=>{const key=Array.isArray(loc)?loc:[loc],length=key.length;return function(obj,defaultValue){if(0===length)return null!=obj?obj:defaultValue;let index=0;for(;null!=obj&&index<length;)obj=obj[key[index++]];return index===length?obj:defaultValue}}},"../indicators/lib/utils/slidingWindow.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _functor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../indicators/lib/utils/functor.js"),_path__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../indicators/lib/utils/path.js");function __WEBPACK_DEFAULT_EXPORT__(){let undefinedValue,sourcePath,source,misc,windowSize=10,accumulator=()=>{},skipInitial=0;const slidingWindow=data=>{const sourceFunction=source||(0,_path__WEBPACK_IMPORTED_MODULE_1__.A)(sourcePath),size=(0,_functor__WEBPACK_IMPORTED_MODULE_0__.E)(windowSize).apply(this,arguments),windowData=data.slice(skipInitial,size+skipInitial).map(sourceFunction);let accumulatorIdx=0;const undef=(0,_functor__WEBPACK_IMPORTED_MODULE_0__.E)(undefinedValue);return data.map((d,i)=>i<skipInitial+size-1?undef(sourceFunction(d),i,misc):(i>=skipInitial+size&&(windowData.shift(),windowData.push(sourceFunction(d,i))),accumulator(windowData,i,accumulatorIdx++,misc)))};return slidingWindow.undefinedValue=function(x){return arguments.length?(undefinedValue=x,slidingWindow):undefinedValue},slidingWindow.windowSize=function(x){return arguments.length?(windowSize=x,slidingWindow):windowSize},slidingWindow.misc=function(x){return arguments.length?(misc=x,slidingWindow):misc},slidingWindow.accumulator=function(x){return arguments.length?(accumulator=x,slidingWindow):accumulator},slidingWindow.skipInitial=function(x){return arguments.length?(skipInitial=x,slidingWindow):skipInitial},slidingWindow.sourcePath=function(x){return arguments.length?(sourcePath=x,slidingWindow):sourcePath},slidingWindow.source=function(x){return arguments.length?(source=x,slidingWindow):source},slidingWindow}},"../indicators/lib/utils/zipper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>zipper});var d3_array__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/d3-array/src/min.js"),_identity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../indicators/lib/utils/identity.js");function zipper(){let combine=_identity__WEBPACK_IMPORTED_MODULE_1__.D;function zip(){const n=arguments.length;if(0===n)return[];const m=(0,d3_array__WEBPACK_IMPORTED_MODULE_0__.A)(arguments,d3_zipLength)??0,zips=new Array(m);for(let i=-1;++i<m;){for(let j=-1,zip=zips[i]=new Array(n);++j<n;)zip[j]=arguments[j][i];zips[i]=combine.apply(this,zips[i])}return zips}function d3_zipLength(d){return d.length}return zip.combine=function(x){return arguments.length?(combine=x,zip):combine},zip}},"../series/lib/AreaOnlySeries.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>AreaOnlySeries});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/utils/index.js"),d3_shape__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/d3-shape/src/area.js"),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/react/index.js");class AreaOnlySeries extends react__WEBPACK_IMPORTED_MODULE_5__.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const{connectNulls,fillStyle,curve,canvasClip,yAccessor,defined=AreaOnlySeries.defaultProps.defined,base}=this.props,{xScale,chartConfig:{yScale},plotData,xAccessor}=moreProps;void 0!==canvasClip&&(ctx.save(),canvasClip(ctx,moreProps)),void 0!==fillStyle&&(ctx.fillStyle="string"==typeof fillStyle?fillStyle:fillStyle(ctx,moreProps));const newBase=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(base),areaSeries=(0,d3_shape__WEBPACK_IMPORTED_MODULE_4__.A)().x(d=>Math.round(xScale(xAccessor(d)))).y0(d=>newBase(yScale,d,moreProps)).y1(d=>Math.round(yScale(yAccessor(d))));void 0!==curve&&areaSeries.curve(curve),connectNulls||areaSeries.defined(d=>defined(yAccessor(d))),ctx.beginPath(),areaSeries.context(ctx)(plotData),ctx.fill(),void 0!==canvasClip&&ctx.restore()}}render(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.P,{canvasDraw:this.drawOnCanvas,canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.WJ,drawOn:["pan"]})}}AreaOnlySeries.defaultProps={connectNulls:!1,defined:d=>void 0!==d&&!isNaN(d),base:yScale=>(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.$1)(yScale.range())}},"../series/lib/CandlestickSeries.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>CandlestickSeries});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/utils/index.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../core/lib/utils/barWidth.js"),d3_array__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-array/src/group.js"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/index.js");class CandlestickSeries extends react__WEBPACK_IMPORTED_MODULE_6__.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const{candleStrokeWidth=CandlestickSeries.defaultProps.candleStrokeWidth}=this.props,{xScale,chartConfig:{yScale},plotData,xAccessor}=moreProps,candleData=this.getCandleData(xAccessor,xScale,yScale,plotData);(0,d3_array__WEBPACK_IMPORTED_MODULE_5__.Ay)(candleData,d=>d.wick.stroke).forEach((values,key)=>{ctx.fillStyle=key,values.forEach(each=>{const d=each.wick;ctx.fillRect(d.x-.5,d.y1,1,d.y2-d.y1),ctx.fillRect(d.x-.5,d.y3,1,d.y4-d.y3)})});(0,d3_array__WEBPACK_IMPORTED_MODULE_5__.Ay)(candleData,d=>d.stroke,d=>d.fill).forEach((strokeValues,strokeKey)=>{"none"!==strokeKey&&(ctx.strokeStyle=strokeKey,ctx.lineWidth=candleStrokeWidth),strokeValues.forEach((values,key)=>{ctx.fillStyle=key,values.forEach(d=>{d.width<=1?ctx.fillRect(d.x-.5,d.y,1,d.height):0===d.height?ctx.fillRect(d.x-.5,d.y,d.width,1):(ctx.fillRect(d.x-.5,d.y,d.width,d.height),"none"!==strokeKey&&ctx.strokeRect(d.x,d.y,d.width,d.height))})})})},this.getCandleData=(xAccessor,xScale,yScale,plotData)=>{const{fill:fillProp,stroke:strokeProp,yAccessor,wickStroke:wickStrokeProp}=this.props,fill=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(fillProp),stroke=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(strokeProp),wickStroke=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(wickStrokeProp),offset=.5*(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(this.props.width)(this.props,{xScale,xAccessor,plotData});return plotData.filter(d=>void 0!==yAccessor(d)).map(d=>{const ohlc=yAccessor(d);if(void 0===ohlc)return;const xValue=xAccessor(d),x=xScale(xValue),y=Math.round(yScale(Math.max(ohlc.open,ohlc.close))),height=Math.max(1,Math.round(Math.abs(yScale(ohlc.open)-yScale(ohlc.close))));return{x:x-offset,y,wick:{stroke:wickStroke(ohlc),x,y1:Math.round(yScale(ohlc.high)),y2:y,y3:y+height,y4:Math.round(yScale(ohlc.low))},height,width:2*offset,fill:fill(ohlc),stroke:stroke(ohlc),direction:ohlc.close-ohlc.open}}).filter(d=>void 0!==d)}}render(){const{clip}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.P,{clip,canvasDraw:this.drawOnCanvas,canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.WJ,drawOn:["pan"]})}}CandlestickSeries.defaultProps={candleStrokeWidth:.5,clip:!0,fill:d=>d.close>d.open?"#26a69a":"#ef5350",stroke:"none",wickStroke:d=>d.close>d.open?"#26a69a":"#ef5350",width:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.h,widthRatio:.8,yAccessor:d=>({open:d.open,high:d.high,low:d.low,close:d.close})}},"../series/lib/LineSeries.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>LineSeries});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/utils/closestItem.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../core/lib/utils/strokeDasharray.js"),d3_shape__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-shape/src/line.js"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/index.js");class LineSeries extends react__WEBPACK_IMPORTED_MODULE_6__.Component{constructor(){super(...arguments),this.drawOnCanvas=lineDash=>(ctx,moreProps)=>{const{connectNulls,yAccessor,hoverStrokeWidth=LineSeries.defaultProps.hoverStrokeWidth,defined=LineSeries.defaultProps.defined,curve,canvasClip,strokeStyle,strokeWidth=LineSeries.defaultProps.strokeWidth}=this.props,{xAccessor,xScale,chartConfig,plotData,hovering}=moreProps;if(!chartConfig)return void console.warn("LineSeries received no chartConfig, is it inside of a Chart?");const{yScale}=chartConfig;void 0!==canvasClip&&(ctx.save(),canvasClip(ctx,moreProps)),ctx.lineWidth=hovering?hoverStrokeWidth:strokeWidth,void 0!==strokeStyle&&(ctx.strokeStyle=strokeStyle),void 0!==lineDash&&ctx.setLineDash(lineDash);const dataSeries=(0,d3_shape__WEBPACK_IMPORTED_MODULE_5__.A)().x(d=>Math.round(xScale(xAccessor(d)))).y(d=>Math.round(yScale(yAccessor(d))));void 0!==curve&&dataSeries.curve(curve),connectNulls||dataSeries.defined(d=>defined(yAccessor(d))),ctx.beginPath(),dataSeries.context(ctx)(plotData),ctx.stroke(),void 0!==canvasClip&&ctx.restore()},this.isHover=moreProps=>{const{highlightOnHover,yAccessor,hoverTolerance=LineSeries.defaultProps.hoverTolerance}=this.props;if(!highlightOnHover)return!1;const{chartConfig:{yScale,origin},xAccessor,mouseXY,currentItem,xScale,plotData}=moreProps,[x,y]=mouseXY,radius=hoverTolerance,{left,right}=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.f)(plotData,xScale.invert(x),xAccessor);if(left===right){const cy=yScale(yAccessor(currentItem))+origin[1],cx=xScale(xAccessor(currentItem))+origin[0];return Math.pow(x-cx,2)+Math.pow(y-cy,2)<Math.pow(radius,2)}{const l=plotData[left],r=plotData[right],x1=xScale(xAccessor(l))+origin[0],y1=yScale(yAccessor(l))+origin[1],x2=xScale(xAccessor(r))+origin[0],m=(yScale(yAccessor(r))+origin[1]-y1)/(x2-x1),b=-1*m*x1+y1,desiredY=Math.round(m*x+b);return y>=desiredY-radius&&y<=desiredY+radius}}}render(){const{highlightOnHover,onClick,onContextMenu,onDoubleClick,onHover,onUnHover,strokeDasharray}=this.props,hoverProps=highlightOnHover||onHover||onUnHover?{isHover:this.isHover,drawOn:["mousemove","pan"],canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.wk}:{drawOn:["pan"],canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.WJ},lineDash=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.y)(strokeDasharray);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.P,{canvasDraw:this.drawOnCanvas(lineDash),onClickWhenHover:onClick,onDoubleClickWhenHover:onDoubleClick,onContextMenuWhenHover:onContextMenu,onHover,onUnHover,...hoverProps})}}LineSeries.defaultProps={connectNulls:!1,defined:d=>void 0!==d&&!isNaN(d),hoverStrokeWidth:4,hoverTolerance:6,highlightOnHover:!1,strokeDasharray:"Solid",strokeStyle:"#2196f3",strokeWidth:1}},"../series/src/AreaOnlySeries.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>AreaOnlySeries});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/utils/index.js"),d3_shape__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/d3-shape/src/area.js"),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/react/index.js");class AreaOnlySeries extends react__WEBPACK_IMPORTED_MODULE_5__.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const{connectNulls,fillStyle,curve,canvasClip,yAccessor,defined=AreaOnlySeries.defaultProps.defined,base}=this.props,{xScale,chartConfig:{yScale},plotData,xAccessor}=moreProps;void 0!==canvasClip&&(ctx.save(),canvasClip(ctx,moreProps)),void 0!==fillStyle&&(ctx.fillStyle="string"==typeof fillStyle?fillStyle:fillStyle(ctx,moreProps));const newBase=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(base),areaSeries=(0,d3_shape__WEBPACK_IMPORTED_MODULE_4__.A)().x(d=>Math.round(xScale(xAccessor(d)))).y0(d=>newBase(yScale,d,moreProps)).y1(d=>Math.round(yScale(yAccessor(d))));void 0!==curve&&areaSeries.curve(curve),connectNulls||areaSeries.defined(d=>defined(yAccessor(d))),ctx.beginPath(),areaSeries.context(ctx)(plotData),ctx.fill(),void 0!==canvasClip&&ctx.restore()}}render(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.P,{canvasDraw:this.drawOnCanvas,canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.WJ,drawOn:["pan"]})}}AreaOnlySeries.defaultProps={connectNulls:!1,defined:d=>void 0!==d&&!isNaN(d),base:yScale=>(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.$1)(yScale.range())}},"../series/src/LineSeries.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>LineSeries});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/utils/closestItem.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../core/lib/utils/strokeDasharray.js"),d3_shape__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-shape/src/line.js"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/index.js");class LineSeries extends react__WEBPACK_IMPORTED_MODULE_6__.Component{constructor(){super(...arguments),this.drawOnCanvas=lineDash=>(ctx,moreProps)=>{const{connectNulls,yAccessor,hoverStrokeWidth=LineSeries.defaultProps.hoverStrokeWidth,defined=LineSeries.defaultProps.defined,curve,canvasClip,strokeStyle,strokeWidth=LineSeries.defaultProps.strokeWidth}=this.props,{xAccessor,xScale,chartConfig,plotData,hovering}=moreProps;if(!chartConfig)return void console.warn("LineSeries received no chartConfig, is it inside of a Chart?");const{yScale}=chartConfig;void 0!==canvasClip&&(ctx.save(),canvasClip(ctx,moreProps)),ctx.lineWidth=hovering?hoverStrokeWidth:strokeWidth,void 0!==strokeStyle&&(ctx.strokeStyle=strokeStyle),void 0!==lineDash&&ctx.setLineDash(lineDash);const dataSeries=(0,d3_shape__WEBPACK_IMPORTED_MODULE_5__.A)().x(d=>Math.round(xScale(xAccessor(d)))).y(d=>Math.round(yScale(yAccessor(d))));void 0!==curve&&dataSeries.curve(curve),connectNulls||dataSeries.defined(d=>defined(yAccessor(d))),ctx.beginPath(),dataSeries.context(ctx)(plotData),ctx.stroke(),void 0!==canvasClip&&ctx.restore()},this.isHover=moreProps=>{const{highlightOnHover,yAccessor,hoverTolerance=LineSeries.defaultProps.hoverTolerance}=this.props;if(!highlightOnHover)return!1;const{chartConfig:{yScale,origin},xAccessor,mouseXY,currentItem,xScale,plotData}=moreProps,[x,y]=mouseXY,radius=hoverTolerance,{left,right}=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.f)(plotData,xScale.invert(x),xAccessor);if(left===right){const cy=yScale(yAccessor(currentItem))+origin[1],cx=xScale(xAccessor(currentItem))+origin[0];return Math.pow(x-cx,2)+Math.pow(y-cy,2)<Math.pow(radius,2)}{const l=plotData[left],r=plotData[right],x1=xScale(xAccessor(l))+origin[0],y1=yScale(yAccessor(l))+origin[1],x2=xScale(xAccessor(r))+origin[0],m=(yScale(yAccessor(r))+origin[1]-y1)/(x2-x1),b=-1*m*x1+y1,desiredY=Math.round(m*x+b);return y>=desiredY-radius&&y<=desiredY+radius}}}render(){const{highlightOnHover,onClick,onContextMenu,onDoubleClick,onHover,onUnHover,strokeDasharray}=this.props,hoverProps=highlightOnHover||onHover||onUnHover?{isHover:this.isHover,drawOn:["mousemove","pan"],canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.wk}:{drawOn:["pan"],canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.WJ},lineDash=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.y)(strokeDasharray);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.P,{canvasDraw:this.drawOnCanvas(lineDash),onClickWhenHover:onClick,onDoubleClickWhenHover:onDoubleClick,onContextMenuWhenHover:onContextMenu,onHover,onUnHover,...hoverProps})}}LineSeries.defaultProps={connectNulls:!1,defined:d=>void 0!==d&&!isNaN(d),hoverStrokeWidth:4,hoverTolerance:6,highlightOnHover:!1,strokeDasharray:"Solid",strokeStyle:"#2196f3",strokeWidth:1}},"../tooltip/lib/ToolTipTSpanLabel.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>ToolTipTSpanLabel});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js");class ToolTipTSpanLabel extends react__WEBPACK_IMPORTED_MODULE_1__.PureComponent{render(){const{children,...rest}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("tspan",{...rest,children})}}ToolTipTSpanLabel.defaultProps={className:"react-financial-charts-tooltip-label",fill:"#4682B4"}},"../tooltip/lib/ToolTipText.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{z:()=>ToolTipText});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js");class ToolTipText extends react__WEBPACK_IMPORTED_MODULE_1__.PureComponent{render(){const{children,...rest}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("text",{...rest,children})}}ToolTipText.defaultProps={className:"react-financial-charts-tooltip",fontFamily:"-apple-system, system-ui, 'Helvetica Neue', Ubuntu, sans-serif",fontSize:11}},"./src/indicators/bollingerBand/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,basic:()=>basic,default:()=>index_stories});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react=__webpack_require__("../../node_modules/react/index.js"),AreaOnlySeries=__webpack_require__("../series/src/AreaOnlySeries.tsx"),LineSeries=__webpack_require__("../series/src/LineSeries.tsx");class BollingerSeries extends react.Component{constructor(){super(...arguments),this.yAccessorForScaledBottom=(scale,d)=>{const{yAccessor=BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return scale(bb.bottom)},this.yAccessorForBottom=d=>{const{yAccessor=BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return bb.bottom},this.yAccessorForMiddle=d=>{const{yAccessor=BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return bb.middle},this.yAccessorForTop=d=>{const{yAccessor=BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return bb.top}}render(){const{className,strokeStyle=BollingerSeries.defaultProps.strokeStyle,fillStyle}=this.props;return(0,jsx_runtime.jsxs)("g",{className,children:[(0,jsx_runtime.jsx)(LineSeries.I,{yAccessor:this.yAccessorForTop,strokeStyle:strokeStyle.top}),(0,jsx_runtime.jsx)(LineSeries.I,{yAccessor:this.yAccessorForMiddle,strokeStyle:strokeStyle.middle}),(0,jsx_runtime.jsx)(LineSeries.I,{yAccessor:this.yAccessorForBottom,strokeStyle:strokeStyle.bottom}),(0,jsx_runtime.jsx)(AreaOnlySeries.H,{yAccessor:this.yAccessorForTop,base:this.yAccessorForScaledBottom,fillStyle})]})}}BollingerSeries.defaultProps={areaClassName:"react-financial-charts-bollinger-band-series-area",fillStyle:"rgba(38, 166, 153, 0.05)",strokeStyle:{top:"#26a69a",middle:"#812828",bottom:"#26a69a"},yAccessor:data=>data.bb};var discontinuousTimeScaleProvider=__webpack_require__("../scales/lib/discontinuousTimeScaleProvider.js"),merge=__webpack_require__("../indicators/lib/utils/merge.js"),rebind=__webpack_require__("../indicators/lib/utils/rebind.js"),mean=__webpack_require__("../../node_modules/d3-array/src/mean.js"),deviation=__webpack_require__("../../node_modules/d3-array/src/deviation.js"),path=__webpack_require__("../indicators/lib/utils/path.js"),slidingWindow=__webpack_require__("../indicators/lib/utils/slidingWindow.js"),zipper=__webpack_require__("../indicators/lib/utils/zipper.js"),ema=__webpack_require__("../indicators/lib/calculator/ema.js"),defaultOptionsForComputation=__webpack_require__("../indicators/lib/calculator/defaultOptionsForComputation.js");var baseIndicator=__webpack_require__("../indicators/lib/indicator/baseIndicator.js");function bollingerBand(){const base=(0,baseIndicator.A)().type("BollingerBand"),underlyingAlgorithm=function bollingerband(){let options=defaultOptionsForComputation.qd;const calculator=data=>{const{windowSize,multiplier,movingAverageType,sourcePath}=options,source=(0,path.A)(sourcePath),meanAlgorithm="ema"===movingAverageType?(0,ema.A)().options({windowSize,sourcePath}):(0,slidingWindow.A)().windowSize(windowSize).accumulator(values=>(0,mean.A)(values)).sourcePath(sourcePath);return(0,slidingWindow.A)().windowSize(windowSize).accumulator(values=>{const avg=values[values.length-1].mean,stdDev=(0,deviation.A)(values,each=>source(each.datum));if(void 0!==stdDev)return{top:avg+multiplier*stdDev,middle:avg,bottom:avg-multiplier*stdDev}})((0,zipper.A)().combine((datum,meanValue)=>({datum,mean:meanValue}))(data,meanAlgorithm(data)))};return calculator.undefinedLength=()=>{const{windowSize}=options;return windowSize-1},calculator.options=newOptions=>void 0===newOptions?options:(options={...defaultOptionsForComputation.qd,...newOptions},calculator),calculator}(),mergedAlgorithm=(0,merge.A)().algorithm(underlyingAlgorithm).merge((datum,i)=>{datum.bollingerBand=i}),indicator=(data,options={merge:!0})=>{if(options.merge){if(!base.accessor())throw new Error("Set an accessor to BollingerBand before calculating");return mergedAlgorithm(data)}return underlyingAlgorithm(data)};return(0,rebind.A)(indicator,base,"id","accessor","stroke","fill","echo","type"),(0,rebind.A)(indicator,underlyingAlgorithm,"options"),(0,rebind.A)(indicator,mergedAlgorithm,"merge","skipUndefined"),indicator}var ChartCanvas=__webpack_require__("../core/lib/ChartCanvas.js"),Chart=__webpack_require__("../core/lib/Chart.js"),XAxis=__webpack_require__("../axes/lib/XAxis.js"),YAxis=__webpack_require__("../axes/lib/YAxis.js"),CandlestickSeries=__webpack_require__("../series/lib/CandlestickSeries.js"),lib_AreaOnlySeries=__webpack_require__("../series/lib/AreaOnlySeries.js"),lib_LineSeries=__webpack_require__("../series/lib/LineSeries.js");class BollingerSeries_BollingerSeries extends react.Component{constructor(){super(...arguments),this.yAccessorForScaledBottom=(scale,d)=>{const{yAccessor=BollingerSeries_BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return scale(bb.bottom)},this.yAccessorForBottom=d=>{const{yAccessor=BollingerSeries_BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return bb.bottom},this.yAccessorForMiddle=d=>{const{yAccessor=BollingerSeries_BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return bb.middle},this.yAccessorForTop=d=>{const{yAccessor=BollingerSeries_BollingerSeries.defaultProps.yAccessor}=this.props,bb=yAccessor(d);if(void 0!==bb)return bb.top}}render(){const{className,strokeStyle=BollingerSeries_BollingerSeries.defaultProps.strokeStyle,fillStyle}=this.props;return(0,jsx_runtime.jsxs)("g",{className,children:[(0,jsx_runtime.jsx)(lib_LineSeries.I,{yAccessor:this.yAccessorForTop,strokeStyle:strokeStyle.top}),(0,jsx_runtime.jsx)(lib_LineSeries.I,{yAccessor:this.yAccessorForMiddle,strokeStyle:strokeStyle.middle}),(0,jsx_runtime.jsx)(lib_LineSeries.I,{yAccessor:this.yAccessorForBottom,strokeStyle:strokeStyle.bottom}),(0,jsx_runtime.jsx)(lib_AreaOnlySeries.H,{yAccessor:this.yAccessorForTop,base:this.yAccessorForScaledBottom,fillStyle})]})}}BollingerSeries_BollingerSeries.defaultProps={areaClassName:"react-financial-charts-bollinger-band-series-area",fillStyle:"rgba(38, 166, 153, 0.05)",strokeStyle:{top:"#26a69a",middle:"#812828",bottom:"#26a69a"},yAccessor:data=>data.bb};var utils=__webpack_require__("../core/lib/utils/index.js"),GenericChartComponent=__webpack_require__("../core/lib/GenericChartComponent.js"),defaultLocale=__webpack_require__("../../node_modules/d3-format/src/defaultLocale.js"),ToolTipText=__webpack_require__("../tooltip/lib/ToolTipText.js"),ToolTipTSpanLabel=__webpack_require__("../tooltip/lib/ToolTipTSpanLabel.js");class BollingerBandTooltip extends react.Component{constructor(){super(...arguments),this.renderSVG=moreProps=>{const{onClick,displayFormat,yAccessor=BollingerBandTooltip.defaultProps.yAccessor,options,origin:originProp,textFill,labelFill,labelFontWeight,className,displayValuesFor=BollingerBandTooltip.defaultProps.displayValuesFor,displayInit,fontFamily,fontSize,fontWeight}=this.props,{chartConfig:{width,height},fullData}=moreProps,currentItem=displayValuesFor(this.props,moreProps)??(0,utils.HV)(fullData);let top=displayInit,middle=displayInit,bottom=displayInit;if(void 0!==currentItem){const item=yAccessor(currentItem);void 0!==item&&(top=displayFormat(item.top),middle=displayFormat(item.middle),bottom=displayFormat(item.bottom))}const origin=(0,utils.ER)(originProp),[x,y]=origin(width,height),{sourcePath,windowSize,multiplier,movingAverageType}=options,tooltipLabel=`BB(${sourcePath}, ${windowSize}, ${multiplier}, ${movingAverageType}): `,tooltipValue=`${top}, ${middle}, ${bottom}`;return(0,jsx_runtime.jsx)("g",{transform:`translate(${x}, ${y})`,className,onClick,children:(0,jsx_runtime.jsxs)(ToolTipText.z,{x:0,y:0,fontFamily,fontSize,fontWeight,children:[(0,jsx_runtime.jsx)(ToolTipTSpanLabel.O,{fill:labelFill,fontWeight:labelFontWeight,children:tooltipLabel}),(0,jsx_runtime.jsx)("tspan",{fill:textFill,children:tooltipValue})]})})}}render(){return(0,jsx_runtime.jsx)(GenericChartComponent.P,{clip:!1,svgDraw:this.renderSVG,drawOn:["mousemove"]})}}BollingerBandTooltip.defaultProps={className:"react-financial-charts-tooltip react-financial-charts-bollingerband-tooltip",displayFormat:(0,defaultLocale.GP)(".2f"),displayValuesFor:(_,props)=>props.currentItem,displayInit:"n/a",origin:[8,8],yAccessor:data=>data.bb};var withSize=__webpack_require__("../utils/lib/withSize.js"),withDeviceRatio=__webpack_require__("../utils/lib/withDeviceRatio.js"),data=__webpack_require__("./src/data/index.ts");class BollingerIndicator extends react.Component{constructor(){super(...arguments),this.margin={left:0,right:40,top:8,bottom:24},this.xScaleProvider=(0,discontinuousTimeScaleProvider.L)().inputDateAccessor(d=>d.date),this.yExtents=data=>[data.bb.top,data.bb.bottom]}render(){const{data:initialData,height,ratio,width,...rest}=this.props,calculator=bollingerBand().merge((d,c)=>{d.bb=c}).accessor(d=>d.bb),calculatedData=calculator(initialData),{data,xScale,xAccessor,displayXAccessor}=this.xScaleProvider(calculatedData),max=xAccessor(data[data.length-1]),xExtents=[xAccessor(data[Math.max(0,data.length-100)]),max];return(0,jsx_runtime.jsx)(ChartCanvas.v,{height,ratio,width,margin:this.margin,data,displayXAccessor,seriesName:"Data",xScale,xAccessor,xExtents,children:(0,jsx_runtime.jsxs)(Chart.t,{id:1,yExtents:this.yExtents,children:[(0,jsx_runtime.jsx)(XAxis.W,{}),(0,jsx_runtime.jsx)(YAxis.h,{}),(0,jsx_runtime.jsx)(CandlestickSeries.H,{}),(0,jsx_runtime.jsx)(BollingerSeries_BollingerSeries,{...rest}),(0,jsx_runtime.jsx)(BollingerBandTooltip,{options:calculator.options()})]})})}}const bollingerBand_BollingerIndicator=(0,data.p)()((0,withSize.U)({style:{minHeight:600}})((0,withDeviceRatio.O)()(BollingerIndicator))),index_stories={title:"Visualization/Indicator/Bollinger Band",component:BollingerSeries,argTypes:{fillStyle:{control:"color"},strokeStyle:{control:null}}},basic={render:({fillStyle})=>(0,jsx_runtime.jsx)(bollingerBand_BollingerIndicator,{fillStyle})},__namedExportsOrder=["basic"];basic.parameters={...basic.parameters,docs:{...basic.parameters?.docs,source:{originalSource:"{\n  render: ({\n    fillStyle\n  }) => <BollingerIndicator fillStyle={fillStyle} />\n}",...basic.parameters?.docs?.source}}}}}]);