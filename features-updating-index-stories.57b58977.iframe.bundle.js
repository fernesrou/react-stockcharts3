"use strict";(self.webpackChunk_react_stockcharts3_stories=self.webpackChunk_react_stockcharts3_stories||[]).push([[4350],{"../coordinates/lib/CrossHairCursor.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>CrossHairCursor});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/ChartCanvas.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../core/lib/utils/strokeDasharray.js");class CrossHairCursor extends react__WEBPACK_IMPORTED_MODULE_1__.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const lines=this.getLines(this.props,moreProps);if(void 0===lines)return;const{margin,ratio}=this.context,originX=.5*ratio+margin.left,originY=.5*ratio+margin.top;ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.scale(ratio,ratio),ctx.translate(originX,originY),lines.forEach(line=>{const dashArray=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.y)(line.strokeDasharray);ctx.strokeStyle=line.strokeStyle,ctx.lineWidth=line.strokeWidth,ctx.setLineDash(dashArray),ctx.beginPath(),ctx.moveTo(line.x1,line.y1),ctx.lineTo(line.x2,line.y2),ctx.stroke()}),ctx.restore()},this.getLines=(props,moreProps)=>{const{mouseXY,currentItem,show,height,width}=moreProps,{customX=CrossHairCursor.defaultProps.customX,strokeStyle=CrossHairCursor.defaultProps.strokeStyle,strokeDasharray,strokeWidth=CrossHairCursor.defaultProps.strokeWidth}=props;if(!show||void 0===currentItem)return;const line1={x1:0,x2:width,y1:mouseXY[1]+.5,y2:mouseXY[1]+.5,strokeStyle,strokeDasharray,strokeWidth},x=customX(props,moreProps);return[line1,{x1:x,x2:x,y1:0,y2:height,strokeStyle,strokeDasharray,strokeWidth}]}}render(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.By,{clip:!1,canvasDraw:this.drawOnCanvas,canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.wk,drawOn:["mousemove","pan","drag"]})}}CrossHairCursor.defaultProps={customX:(props,moreProps)=>{const{xScale,xAccessor,currentItem,mouseXY}=moreProps,{snapX}=props;return snapX?Math.round(xScale(xAccessor(currentItem))):mouseXY[0]+.5},snapX:!0,strokeStyle:"rgba(55, 71, 79, 0.8)",strokeDasharray:"Dash",strokeWidth:1},CrossHairCursor.contextType=_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.c0},"../core/lib/utils/barWidth.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>plotDataLengthBarWidth});var ___WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../core/lib/utils/index.js");const plotDataLengthBarWidth=(props,moreProps)=>{const{widthRatio}=props,{xAccessor,xScale,plotData}=moreProps,[l,r]=xScale.range();if(null!=xScale.invert){const[dl,dr]=xScale.domain();if("number"==typeof dl&&"number"==typeof dr){return Math.abs(r-l)/Math.abs(dl-dr)*widthRatio}return(xScale(xAccessor((0,___WEBPACK_IMPORTED_MODULE_0__.HV)(plotData)))-xScale(xAccessor((0,___WEBPACK_IMPORTED_MODULE_0__.$1)(plotData))))/plotData.length*widthRatio*.7}return Math.abs(r-l)/xScale.domain().length*widthRatio}},"../scales/lib/timeFormat.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>timeFormat});var d3_time__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/d3-time/src/second.js"),d3_time__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/d3-time/src/minute.js"),d3_time__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/d3-time/src/hour.js"),d3_time__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/d3-time/src/day.js"),d3_time__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/d3-time/src/week.js"),d3_time__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-time/src/month.js"),d3_time__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/d3-time/src/year.js"),d3_time_format__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/d3-time-format/src/defaultLocale.js");const formatMillisecond=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)(".%L"),formatSecond=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)(":%S"),formatMinute=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%H:%M"),formatHour=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%H:%M"),formatDay=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%e"),formatWeek=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%e"),formatMonth=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%b"),formatYear=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_7__.DC)("%Y"),timeFormat=date=>((0,d3_time__WEBPACK_IMPORTED_MODULE_0__.R)(date)<date?formatMillisecond:(0,d3_time__WEBPACK_IMPORTED_MODULE_1__.wX)(date)<date?formatSecond:(0,d3_time__WEBPACK_IMPORTED_MODULE_2__.Ag)(date)<date?formatMinute:(0,d3_time__WEBPACK_IMPORTED_MODULE_3__.UA)(date)<date?formatHour:(0,d3_time__WEBPACK_IMPORTED_MODULE_5__.Ui)(date)<date?(0,d3_time__WEBPACK_IMPORTED_MODULE_4__.YP)(date)<date?formatDay:formatWeek:(0,d3_time__WEBPACK_IMPORTED_MODULE_6__.he)(date)<date?formatMonth:formatYear)(date)},"../series/lib/CandlestickSeries.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>CandlestickSeries});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../core/lib/GenericChartComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../core/lib/GenericComponent.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../core/lib/utils/index.js"),_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../core/lib/utils/barWidth.js"),d3_array__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/d3-array/src/group.js"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/index.js");class CandlestickSeries extends react__WEBPACK_IMPORTED_MODULE_6__.Component{constructor(){super(...arguments),this.drawOnCanvas=(ctx,moreProps)=>{const{candleStrokeWidth=CandlestickSeries.defaultProps.candleStrokeWidth}=this.props,{xScale,chartConfig:{yScale},plotData,xAccessor}=moreProps,candleData=this.getCandleData(xAccessor,xScale,yScale,plotData);(0,d3_array__WEBPACK_IMPORTED_MODULE_5__.Ay)(candleData,d=>d.wick.stroke).forEach((values,key)=>{ctx.fillStyle=key,values.forEach(each=>{const d=each.wick;ctx.fillRect(d.x-.5,d.y1,1,d.y2-d.y1),ctx.fillRect(d.x-.5,d.y3,1,d.y4-d.y3)})});(0,d3_array__WEBPACK_IMPORTED_MODULE_5__.Ay)(candleData,d=>d.stroke,d=>d.fill).forEach((strokeValues,strokeKey)=>{"none"!==strokeKey&&(ctx.strokeStyle=strokeKey,ctx.lineWidth=candleStrokeWidth),strokeValues.forEach((values,key)=>{ctx.fillStyle=key,values.forEach(d=>{d.width<=1?ctx.fillRect(d.x-.5,d.y,1,d.height):0===d.height?ctx.fillRect(d.x-.5,d.y,d.width,1):(ctx.fillRect(d.x-.5,d.y,d.width,d.height),"none"!==strokeKey&&ctx.strokeRect(d.x,d.y,d.width,d.height))})})})},this.getCandleData=(xAccessor,xScale,yScale,plotData)=>{const{fill:fillProp,stroke:strokeProp,yAccessor,wickStroke:wickStrokeProp}=this.props,fill=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(fillProp),stroke=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(strokeProp),wickStroke=(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(wickStrokeProp),offset=.5*(0,_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_3__.ER)(this.props.width)(this.props,{xScale,xAccessor,plotData});return plotData.filter(d=>void 0!==yAccessor(d)).map(d=>{const ohlc=yAccessor(d);if(void 0===ohlc)return;const xValue=xAccessor(d),x=xScale(xValue),y=Math.round(yScale(Math.max(ohlc.open,ohlc.close))),height=Math.max(1,Math.round(Math.abs(yScale(ohlc.open)-yScale(ohlc.close))));return{x:x-offset,y,wick:{stroke:wickStroke(ohlc),x,y1:Math.round(yScale(ohlc.high)),y2:y,y3:y+height,y4:Math.round(yScale(ohlc.low))},height,width:2*offset,fill:fill(ohlc),stroke:stroke(ohlc),direction:ohlc.close-ohlc.open}}).filter(d=>void 0!==d)}}render(){const{clip}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_1__.P,{clip,canvasDraw:this.drawOnCanvas,canvasToDraw:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_2__.WJ,drawOn:["pan"]})}}CandlestickSeries.defaultProps={candleStrokeWidth:.5,clip:!0,fill:d=>d.close>d.open?"#26a69a":"#ef5350",stroke:"none",wickStroke:d=>d.close>d.open?"#26a69a":"#ef5350",width:_react_stockcharts3_core__WEBPACK_IMPORTED_MODULE_4__.h,widthRatio:.8,yAccessor:d=>({open:d.open,high:d.high,low:d.low,close:d.close})}},"./src/data/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>withOHLCData,R:()=>withUpdatingData});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),tsv=__webpack_require__("../../node_modules/d3-dsv/src/tsv.js"),defaultLocale=__webpack_require__("../../node_modules/d3-time-format/src/defaultLocale.js"),react=__webpack_require__("../../node_modules/react/index.js");const parseDate=(0,defaultLocale.T6)("%Y-%m-%d"),parseData=()=>d=>{const date=parseDate(d.date);d.date=null===date?new Date(Number(d.date)):new Date(date);for(const key in d)"date"!==key&&Object.prototype.hasOwnProperty.call(d,key)&&(d[key]=+d[key]);return d};function withOHLCData(dataSet="DAILY"){return OriginalComponent=>class WithOHLCData extends react.Component{constructor(props){super(props),this.state={message:`Loading ${dataSet} data...`}}componentDidMount(){fetch(`https://raw.githubusercontent.com/reactivemarkets/react-financial-charts/master/packages/stories/src/data/${dataSet}.tsv`).then(response=>response.text()).then(data=>(0,tsv.Nu)(data,parseData())).then(data=>{this.setState({data})}).catch(()=>{this.setState({message:"Failed to fetch data."})})}render(){const{data,message}=this.state;return void 0===data?(0,jsx_runtime.jsx)("div",{className:"center",children:message}):(0,jsx_runtime.jsx)(OriginalComponent,{...this.props,data})}}}function withUpdatingData(initialLength=120,interval=1e3){return OriginalComponent=>class WithOHLCData extends react.Component{constructor(props){super(props),this.state={data:props.data.slice(0,initialLength),length:initialLength}}componentDidMount(){this.interval=window.setInterval(()=>{const{data}=this.props,{length}=this.state;length<data.length?this.setState({data:data.slice(0,length+1),length:length+1}):window.clearInterval(this.interval)},interval)}componentWillUnmount(){window.clearInterval(this.interval)}render(){const{data}=this.state;return(0,jsx_runtime.jsx)(OriginalComponent,{...this.props,data})}}}},"./src/features/updating/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,continuous:()=>continuous,default:()=>index_stories});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),time=__webpack_require__("../../node_modules/d3-scale/src/time.js"),react=__webpack_require__("../../node_modules/react/index.js"),ChartCanvas=__webpack_require__("../core/lib/ChartCanvas.js"),Chart=__webpack_require__("../core/lib/Chart.js"),CandlestickSeries=__webpack_require__("../series/lib/CandlestickSeries.js"),XAxis=__webpack_require__("../axes/lib/XAxis.js"),timeFormat=__webpack_require__("../scales/lib/timeFormat.js"),YAxis=__webpack_require__("../axes/lib/YAxis.js"),CrossHairCursor=__webpack_require__("../coordinates/lib/CrossHairCursor.js"),withSize=__webpack_require__("../utils/lib/withSize.js"),withDeviceRatio=__webpack_require__("../utils/lib/withDeviceRatio.js"),data=__webpack_require__("./src/data/index.ts");class BasicLineSeries extends react.Component{constructor(){super(...arguments),this.margin={left:0,right:56,top:0,bottom:24},this.padding={left:0,right:32,top:0,bottom:0},this.yExtentsCalculator=({plotData})=>{let min,max;for(const{low,high}of plotData)void 0===min&&(min=low),void 0===max&&(max=high),void 0!==low&&min>low&&(min=low),void 0!==high&&max<high&&(max=high);void 0===min&&(min=0),void 0===max&&(max=0);const padding=.1*(max-min);return[min-padding,max+2*padding]}}render(){const{data,height,ratio,width}=this.props,xScale=(0,time.A)();return(0,jsx_runtime.jsxs)(ChartCanvas.v,{height,ratio,width,margin:this.margin,padding:this.padding,data,seriesName:"Data",xScale,xAccessor:d=>d.date,children:[(0,jsx_runtime.jsxs)(Chart.t,{id:1,yExtentsCalculator:this.yExtentsCalculator,children:[(0,jsx_runtime.jsx)(CandlestickSeries.H,{}),(0,jsx_runtime.jsx)(XAxis.W,{tickFormat:timeFormat.D}),(0,jsx_runtime.jsx)(YAxis.h,{})]}),(0,jsx_runtime.jsx)(CrossHairCursor.H,{snapX:!1})]})}}const Updating=(0,data.p)("SECONDS")((0,data.R)()((0,withSize.U)({style:{minHeight:600}})((0,withDeviceRatio.O)()(BasicLineSeries)))),index_stories={title:"Features/Updating",component:Updating},continuous={render:()=>(0,jsx_runtime.jsx)(Updating,{})},__namedExportsOrder=["continuous"];continuous.parameters={...continuous.parameters,docs:{...continuous.parameters?.docs,source:{originalSource:"{\n  render: () => <Updating />\n}",...continuous.parameters?.docs?.source}}}}}]);